<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>Fuck</title>
</head>
<body>
    <button id="uploadBtn">変更した。</button>
    <input type="file" id="fileInput" accept=".xlsx,.xls" style="display:none">
    <h1>Fuck</h1>


    <script>
        document.getElementById('uploadBtn').addEventListener('click', () => {
            document.getElementById('fileInput').click();
        });

        document.getElementById('fileInput').addEventListener('change', async (event) => {
            const file = event.target.files[0];
            if (!file) return;

            const formData = new FormData();
            formData.append('file', file);

            const response = await fetch('/convert', {
                method: 'POST',
                body: formData
            });

            if (response.ok) {
                const blob = await response.blob();
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = file.name.replace(/\.[^/.]+$/, '') + ".pdf";
                document.body.appendChild(a);
                a.click();
                a.remove();
                URL.revokeObjectURL(url);
            } else {
                alert("変換に失敗しました");
            }
        });
    </script>
</body>
</html>
